
<div class="container">
<!--Botones de ingreso y reingreso de productos-->
<div class="row">
  <div class="col">
    <h1>Inventario</h1>
  </div>
  <div class="col">
    <div class="btn-group float-right">
      <button type="button" class="btn btn-success" data-toggle="modal" data-target="#modalIngreso">Ingreso</button>
      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalReingreso">Reingreso</button>
      <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#modalEgreso">Egreso</button>
      <button type="button" class="btn btn-info" data-toggle="modal" data-target="#modalModificar">Modificar</button>
    </div>
  </div>
</div>

<div class="row">
  <!--Tabla de inventario en donde se muestra el inventario general-->
    <table class="table shadow">
      <thead class="thead-dark">
        <tr>
          <!--Filtro por nombre de Inventario, busca el item que haga match-->
          <th scope="col">
            <input #filtroNombre="ngModel" class="w-75 form-control form-control-sm" ngModel type="text" placeholder="Filtro por nombre">
          </th>

          <th scope="col">
            <select #filtroCategoria="ngModel" class="form-control form-control-sm" ngModel name="filtroCategoria">
              <option value="">Categoría (Todas)</option>
              <option *ngFor="let cat of categorias" [value]="cat.nombre">{{ cat.nombre }}</option>
            </select>
          </th>
          <th scope="col"></th>
          <th scope="col">
            <select #filtroUbicacion="ngModel" class="form-control form-control-sm" ngModel name="filtroUbicacion">
              <option value="">Ubicación (Todas)</option>
              <option *ngFor="let ubicacion of ubicaciones" [value]="ubicacion.nombre">{{ ubicacion.nombre }}</option>
            </select>
          </th>
          <th scope="col"></th>
          <th scope="col"></th>
        </tr>
      </thead>
      <thead class="thead-dark">
        <tr>
          <th scope="col">Nombre</th>
          <th scope="col">Categoría</th>
          <th scope="col">Cantidad</th>
          <th scope="col">Ubicación</th>
          <th scope="col">Estado</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
      <!-- *ngIf="(item.nombre.toLocaleLowerCase().includes(filtroNombre.value.toLowerCase() || item.tipo == filtroCategoria.value)) || filtroNombre.value == ''" -->

      <!--NgFor que imprime inventario de base de datos (itemsInventario), este a su vez compara con el Filtro por nombre en minusculas-->
        <ng-container *ngFor="let item of inventario">
          <tr
            scope="row"
            *ngIf="(
              (item.nombre.toLocaleLowerCase().includes(filtroNombre.value.toLowerCase()) || filtroNombre.value == '')
              &&
              (item.tipo == filtroCategoria.value || filtroCategoria.value == '')
              &&
              (item.ubicacion == filtroUbicacion.value || filtroUbicacion.value == '')
            )"
            class="bg-light">
            <td>{{ item.nombre }}</td>
            <td>{{ item.tipo }}</td>
            <td><span [ngClass]="{'text-danger': item.estado=='En Obra'}">{{ item.cantidad }} {{ item.unidades }}</span></td>
            <td>{{ item.ubicacion }}</td>
            <td [ngClass]="{'text-success': item.estado=='Disponible',
                            'text-danger': item.estado=='Dañado',
                            'text-info': item.estado=='En Obra'}">{{ item.estado }}</td>
            <td>
              <button (click)="asignarDetalles(item)" type="button" class="btn btn-info btn-sm" data-toggle="modal" data-target="#modalInfo">Detalles</button>
            </td>
          </tr>
        </ng-container>
      </tbody>
  </table>
</div>
<!-- MODAL DE INFO -->
<div class="modal fade" id="modalInfo" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-info">
        <h5 class="modal-title text-white" id="exampleModalLabel"><strong>{{ datosInfo.nombre }}</strong></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <table class="table table-sm">
          <tbody>
              <tr>
                <th>ID</th>
                  <td></td>
                  <td>{{ datosInfo.id }}</td>
              </tr>
              <tr>
                <th>Serial</th>
                  <td></td>
                  <td>{{ datosInfo.serial }}</td>
              </tr>
              <tr>
                <th>Categoría</th>
                  <td></td>
                  <td>{{ datosInfo.tipo }}</td>
              </tr>
              <tr>
                <th>Cantidad</th>
                  <td></td>
                  <td>{{ datosInfo.cantidad }}</td>
              </tr>
              <tr>
                <th>Ubicación</th>
                  <td></td>
                  <td>{{ datosInfo.ubicacion }}</td>
              </tr>
              <tr>
                <th>Primer ingreso por</th>
                  <td></td>
                  <td>{{ datosInfo.responsable }} ({{ datosInfo.fecha }})</td>
              </tr>
              <tr>
                <th>Estado</th>
                  <td></td>
                  <td>{{ datosInfo.estado }}</td>
              </tr>
              <tr>
                <th>Vencimiento</th>
                  <td></td>
                  <td>{{ datosInfo.vencimiento }}</td>
              </tr>
              <tr>
                <th>Precio</th>
                  <td></td>
                  <td>{{ datosInfo.precio }}</td>
              </tr>
              <tr><th></th><td></td><td></td></tr>

          </tbody>
      </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
<!-- FIN DEL MODAL INFO -->
  </div>


<!-- Modal Ingreso-->
<div class="modal fade" id="modalIngreso" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <app-ingreso></app-ingreso>
</div>
<!-- Modal Reingreso-->
<div class="modal fade" id="modalReingreso" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <app-reingreso></app-reingreso>
</div>
<!-- Modal Egreso-->
<div class="modal fade" id="modalEgreso" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <app-egreso></app-egreso>
</div><!-- Modal Modificar-->
<div class="modal fade" id="modalModificar" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <app-modificar></app-modificar>
</div>
